<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LSTM Example &mdash; scalecast 0.6.4 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/logo2.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Forecaster Class" href="../Forecaster.html" />
    <link rel="prev" title="&lt;no title&gt;" href="eCommerce.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="../../index.html">
            <img src="../../_static/logo2.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.6.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../initialization.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">LSTM Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Data-preprocessing">Data preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#EDA">EDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#LSTM-Model">LSTM Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-1">Attempt 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-2">Attempt 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-3">Attempt 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-4">Attempt 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-5">Attempt 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Attempt-6">Attempt 6</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MLR-Modeling">MLR Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Benchmarking">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Export-Results">Export Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Export-Feature-Info">Export Feature Info</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Forecaster:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Forecaster.html">Forecaster Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ForecasterGlobals.html">Forecaster Object Globals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_forecast.html">Forecasting Different Model Types</a></li>
</ul>
<p class="caption"><span class="caption-text">GridGenerator:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GridGenerator/GridGenerator.html">GridGenerator</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebook:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Notebook/Notebook.html">Notebook</a></li>
</ul>
<p class="caption"><span class="caption-text">Multi-Series:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Multiseries/Multiseries.html">Multi-series</a></li>
</ul>
<p class="caption"><span class="caption-text">ChangeLog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../change_log.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scalecast</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>LSTM Example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Forecaster/examples/LSTM.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="eCommerce.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Forecaster.html" class="btn btn-neutral float-right" title="Forecaster Class" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="LSTM-Example">
<h1>LSTM Example<a class="headerlink" href="#LSTM-Example" title="Permalink to this headline"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scalecast.Forecaster</span> <span class="kn">import</span> <span class="n">Forecaster</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<section id="Data-preprocessing">
<h2>Data preprocessing<a class="headerlink" href="#Data-preprocessing" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;AirPassengers.csv&#39;</span><span class="p">,</span><span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>#Passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1949-01-01</td>
      <td>112</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1949-02-01</td>
      <td>118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1949-03-01</td>
      <td>132</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1949-04-01</td>
      <td>129</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1949-05-01</td>
      <td>121</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(144, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Timestamp(&#39;1949-01-01 00:00:00&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Timestamp(&#39;1960-12-01 00:00:00&#39;)
</pre></div></div>
</div>
</section>
<section id="EDA">
<h2>EDA<a class="headerlink" href="#EDA" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">Forecaster</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;#Passengers&#39;</span><span class="p">],</span><span class="n">current_dates</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_9_0.png" src="../../_images/Forecaster_examples_LSTM_9_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Forecaster(
    DateStartActuals=1949-01-01T00:00:00.000000000
    DateEndActuals=1960-12-01T00:00:00.000000000
    Freq=MS
    ForecastLength=0
    Xvars=[]
    Differenced=0
    TestLength=1
    ValidationLength=1
    ValidationMetric=rmse
    ForecastsEvaluated=[]
    CILevel=0.95
    BootstrapSamples=100
    CurrentEstimator=None
)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_11_0.png" src="../../_images/Forecaster_examples_LSTM_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_12_0.png" src="../../_images/Forecaster_examples_LSTM_12_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_13_0.png" src="../../_images/Forecaster_examples_LSTM_13_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="p">,</span> <span class="n">pval</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">adf_test</span><span class="p">(</span><span class="n">full_res</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.8153688792060569
0.9918802434376411
</pre></div></div>
</div>
</section>
<section id="LSTM-Model">
<h2>LSTM Model<a class="headerlink" href="#LSTM-Model" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">set_test_length</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">generate_future_dates</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_estimator</span><span class="p">(</span><span class="s1">&#39;lstm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Attempt-1">
<h3>Attempt 1<a class="headerlink" href="#Attempt-1" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_default&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4/4 [==============================] - 1s 2ms/step - loss: 0.3507
5/5 [==============================] - 1s 2ms/step - loss: 0.3386
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_18_1.png" src="../../_images/Forecaster_examples_LSTM_18_1.png" />
</div>
</div>
</section>
<section id="Attempt-2">
<h3>Attempt 2<a class="headerlink" href="#Attempt-2" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_24lags&#39;</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3/3 [==============================] - 1s 5ms/step - loss: 0.3823
4/4 [==============================] - 1s 7ms/step - loss: 0.3503
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_20_1.png" src="../../_images/Forecaster_examples_LSTM_20_1.png" />
</div>
</div>
</section>
<section id="Attempt-3">
<h3>Attempt 3<a class="headerlink" href="#Attempt-3" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_24lags_5epochs&#39;</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">validation_split</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/5
3/3 [==============================] - 2s 193ms/step - loss: 0.4549 - val_loss: 0.1873
Epoch 2/5
3/3 [==============================] - 0s 17ms/step - loss: 0.4461 - val_loss: 0.1813
Epoch 3/5
3/3 [==============================] - 0s 15ms/step - loss: 0.4374 - val_loss: 0.1752
Epoch 4/5
3/3 [==============================] - 0s 16ms/step - loss: 0.4287 - val_loss: 0.1691
Epoch 5/5
3/3 [==============================] - 0s 15ms/step - loss: 0.4199 - val_loss: 0.1631
Epoch 1/5
3/3 [==============================] - 2s 166ms/step - loss: 0.4308 - val_loss: 0.1668
Epoch 2/5
3/3 [==============================] - 0s 16ms/step - loss: 0.4225 - val_loss: 0.1609
Epoch 3/5
3/3 [==============================] - 0s 15ms/step - loss: 0.4142 - val_loss: 0.1551
Epoch 4/5
3/3 [==============================] - 0s 17ms/step - loss: 0.4059 - val_loss: 0.1493
Epoch 5/5
3/3 [==============================] - 0s 15ms/step - loss: 0.3975 - val_loss: 0.1434
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_22_1.png" src="../../_images/Forecaster_examples_LSTM_22_1.png" />
</div>
</div>
</section>
<section id="Attempt-4">
<h3>Attempt 4<a class="headerlink" href="#Attempt-4" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_24lags_earlystop_3layers&#39;</span><span class="p">,</span>
                  <span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                  <span class="n">epochs</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                  <span class="n">validation_split</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">callbacks</span><span class="o">=</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                          <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                  <span class="n">lstm_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
                  <span class="n">dropout</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/25
3/3 [==============================] - 4s 432ms/step - loss: 0.4674 - val_loss: 0.1867
Epoch 2/25
3/3 [==============================] - 0s 27ms/step - loss: 0.4491 - val_loss: 0.1720
Epoch 3/25
3/3 [==============================] - 0s 26ms/step - loss: 0.4278 - val_loss: 0.1543
Epoch 4/25
3/3 [==============================] - 0s 26ms/step - loss: 0.4020 - val_loss: 0.1330
Epoch 5/25
3/3 [==============================] - 0s 28ms/step - loss: 0.3686 - val_loss: 0.1132
Epoch 6/25
3/3 [==============================] - 0s 26ms/step - loss: 0.3275 - val_loss: 0.1103
Epoch 7/25
3/3 [==============================] - 0s 26ms/step - loss: 0.2848 - val_loss: 0.1334
Epoch 8/25
3/3 [==============================] - 0s 34ms/step - loss: 0.2618 - val_loss: 0.1648
Epoch 9/25
3/3 [==============================] - 0s 31ms/step - loss: 0.2514 - val_loss: 0.1769
Epoch 10/25
3/3 [==============================] - 0s 27ms/step - loss: 0.2380 - val_loss: 0.1686
Epoch 11/25
3/3 [==============================] - 0s 26ms/step - loss: 0.2179 - val_loss: 0.1489
Epoch 1/25
3/3 [==============================] - 4s 424ms/step - loss: 0.4533 - val_loss: 0.1680
Epoch 2/25
3/3 [==============================] - 0s 33ms/step - loss: 0.4356 - val_loss: 0.1545
Epoch 3/25
3/3 [==============================] - 0s 35ms/step - loss: 0.4168 - val_loss: 0.1382
Epoch 4/25
3/3 [==============================] - 0s 30ms/step - loss: 0.3937 - val_loss: 0.1171
Epoch 5/25
3/3 [==============================] - 0s 32ms/step - loss: 0.3626 - val_loss: 0.0955
Epoch 6/25
3/3 [==============================] - 0s 36ms/step - loss: 0.3200 - val_loss: 0.0889
Epoch 7/25
3/3 [==============================] - 0s 33ms/step - loss: 0.2695 - val_loss: 0.1161
Epoch 8/25
3/3 [==============================] - 0s 33ms/step - loss: 0.2367 - val_loss: 0.1605
Epoch 9/25
3/3 [==============================] - 0s 32ms/step - loss: 0.2269 - val_loss: 0.1860
Epoch 10/25
3/3 [==============================] - 0s 31ms/step - loss: 0.2113 - val_loss: 0.1799
Epoch 11/25
3/3 [==============================] - 0s 39ms/step - loss: 0.1896 - val_loss: 0.1557
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_24_1.png" src="../../_images/Forecaster_examples_LSTM_24_1.png" />
</div>
</div>
</section>
<section id="Attempt-5">
<h3>Attempt 5<a class="headerlink" href="#Attempt-5" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_24lags_4layers_15epochs&#39;</span><span class="p">,</span>
                  <span class="n">lags</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
                  <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                  <span class="n">epochs</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                  <span class="n">validation_split</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span>
                  <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;Adam&#39;</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                  <span class="n">lstm_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">72</span><span class="p">,)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">dropout</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">plot_loss</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">,</span><span class="n">models</span><span class="o">=</span><span class="s1">&#39;top_2&#39;</span><span class="p">,</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/15
3/3 [==============================] - 6s 633ms/step - loss: 0.4843 - val_loss: 0.2002
Epoch 2/15
3/3 [==============================] - 0s 58ms/step - loss: 0.3794 - val_loss: 0.1141
Epoch 3/15
3/3 [==============================] - 0s 61ms/step - loss: 0.2180 - val_loss: 0.1044
Epoch 4/15
3/3 [==============================] - 0s 67ms/step - loss: 0.1162 - val_loss: 0.0598
Epoch 5/15
3/3 [==============================] - 0s 68ms/step - loss: 0.1347 - val_loss: 0.0759
Epoch 6/15
3/3 [==============================] - 0s 65ms/step - loss: 0.1231 - val_loss: 0.0829
Epoch 7/15
3/3 [==============================] - 0s 63ms/step - loss: 0.1053 - val_loss: 0.0593
Epoch 8/15
3/3 [==============================] - ETA: 0s - loss: 0.099 - 0s 62ms/step - loss: 0.0993 - val_loss: 0.0564
Epoch 9/15
3/3 [==============================] - 0s 65ms/step - loss: 0.0973 - val_loss: 0.0532
Epoch 10/15
3/3 [==============================] - 0s 61ms/step - loss: 0.0940 - val_loss: 0.0525
Epoch 11/15
3/3 [==============================] - 0s 58ms/step - loss: 0.0912 - val_loss: 0.0522
Epoch 12/15
3/3 [==============================] - 0s 64ms/step - loss: 0.0908 - val_loss: 0.0568
Epoch 13/15
3/3 [==============================] - 0s 64ms/step - loss: 0.0889 - val_loss: 0.0521
Epoch 14/15
3/3 [==============================] - 0s 67ms/step - loss: 0.0934 - val_loss: 0.0626
Epoch 15/15
3/3 [==============================] - 0s 70ms/step - loss: 0.0921 - val_loss: 0.0564
Epoch 1/15
3/3 [==============================] - 7s 775ms/step - loss: 0.4749 - val_loss: 0.1933
Epoch 2/15
3/3 [==============================] - 0s 62ms/step - loss: 0.4087 - val_loss: 0.1080
Epoch 3/15
3/3 [==============================] - 0s 67ms/step - loss: 0.2353 - val_loss: 0.1847
Epoch 4/15
3/3 [==============================] - 0s 71ms/step - loss: 0.1748 - val_loss: 0.0843
Epoch 5/15
3/3 [==============================] - 0s 69ms/step - loss: 0.1199 - val_loss: 0.0473
Epoch 6/15
3/3 [==============================] - 0s 77ms/step - loss: 0.1194 - val_loss: 0.1083
Epoch 7/15
3/3 [==============================] - 0s 76ms/step - loss: 0.1156 - val_loss: 0.1251
Epoch 8/15
3/3 [==============================] - 0s 76ms/step - loss: 0.1076 - val_loss: 0.0666
Epoch 9/15
3/3 [==============================] - 0s 72ms/step - loss: 0.0979 - val_loss: 0.0580
Epoch 10/15
3/3 [==============================] - 0s 72ms/step - loss: 0.0946 - val_loss: 0.0728
Epoch 11/15
3/3 [==============================] - 0s 70ms/step - loss: 0.0926 - val_loss: 0.0521
Epoch 12/15
3/3 [==============================] - 0s 70ms/step - loss: 0.0865 - val_loss: 0.0472
Epoch 13/15
3/3 [==============================] - 0s 70ms/step - loss: 0.0870 - val_loss: 0.0475
Epoch 14/15
3/3 [==============================] - 0s 68ms/step - loss: 0.0845 - val_loss: 0.0498
Epoch 15/15
3/3 [==============================] - 0s 69ms/step - loss: 0.0831 - val_loss: 0.0576
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_26_1.png" src="../../_images/Forecaster_examples_LSTM_26_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_26_2.png" src="../../_images/Forecaster_examples_LSTM_26_2.png" />
</div>
</div>
</section>
<section id="Attempt-6">
<h3>Attempt 6<a class="headerlink" href="#Attempt-6" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">(</span><span class="n">call_me</span><span class="o">=</span><span class="s1">&#39;lstm_best&#39;</span><span class="p">,</span>
                  <span class="n">lags</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
                  <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                  <span class="n">epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                  <span class="n">validation_split</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span>
                  <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;Adam&#39;</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                  <span class="n">lstm_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,)</span><span class="o">*</span><span class="mi">15</span><span class="p">,</span>
                  <span class="n">dropout</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span><span class="o">*</span><span class="mi">15</span><span class="p">,</span>
                  <span class="n">plot_loss</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">,</span><span class="n">models</span><span class="o">=</span><span class="s1">&#39;top_2&#39;</span><span class="p">,</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/300
5/5 [==============================] - 26s 1s/step - loss: 0.4565 - val_loss: 0.2858
Epoch 2/300
5/5 [==============================] - 1s 295ms/step - loss: 0.1735 - val_loss: 0.2274
Epoch 3/300
5/5 [==============================] - 2s 302ms/step - loss: 0.1574 - val_loss: 0.2142
Epoch 4/300
5/5 [==============================] - 1s 300ms/step - loss: 0.1419 - val_loss: 0.3462
Epoch 5/300
5/5 [==============================] - 2s 308ms/step - loss: 0.1704 - val_loss: 0.1709
Epoch 6/300
5/5 [==============================] - 2s 306ms/step - loss: 0.1314 - val_loss: 0.2677
Epoch 7/300
5/5 [==============================] - 2s 310ms/step - loss: 0.1403 - val_loss: 0.0713
Epoch 8/300
5/5 [==============================] - 1s 300ms/step - loss: 0.1581 - val_loss: 0.1365
Epoch 9/300
5/5 [==============================] - 2s 307ms/step - loss: 0.1226 - val_loss: 0.0815
Epoch 10/300
5/5 [==============================] - 2s 304ms/step - loss: 0.1073 - val_loss: 0.1793
Epoch 11/300
5/5 [==============================] - 2s 311ms/step - loss: 0.1131 - val_loss: 0.1221
Epoch 12/300
5/5 [==============================] - 2s 325ms/step - loss: 0.1080 - val_loss: 0.0530
Epoch 13/300
5/5 [==============================] - 2s 312ms/step - loss: 0.1002 - val_loss: 0.0590
Epoch 14/300
5/5 [==============================] - 2s 317ms/step - loss: 0.0985 - val_loss: 0.0894
Epoch 15/300
5/5 [==============================] - 2s 322ms/step - loss: 0.1030 - val_loss: 0.0711
Epoch 16/300
5/5 [==============================] - 1s 284ms/step - loss: 0.0952 - val_loss: 0.0780
Epoch 17/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0967 - val_loss: 0.0663
Epoch 18/300
5/5 [==============================] - 1s 293ms/step - loss: 0.0916 - val_loss: 0.0725
Epoch 19/300
5/5 [==============================] - 2s 327ms/step - loss: 0.0938 - val_loss: 0.0640
Epoch 20/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0958 - val_loss: 0.0742
Epoch 21/300
5/5 [==============================] - 1s 287ms/step - loss: 0.0919 - val_loss: 0.0649
Epoch 22/300
5/5 [==============================] - 2s 303ms/step - loss: 0.0925 - val_loss: 0.0933
Epoch 23/300
5/5 [==============================] - 2s 315ms/step - loss: 0.0898 - val_loss: 0.0617
Epoch 24/300
5/5 [==============================] - 1s 285ms/step - loss: 0.0925 - val_loss: 0.0576
Epoch 25/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0914 - val_loss: 0.0596
Epoch 26/300
5/5 [==============================] - 1s 299ms/step - loss: 0.0920 - val_loss: 0.0646
Epoch 27/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0906 - val_loss: 0.0591
Epoch 28/300
5/5 [==============================] - 2s 312ms/step - loss: 0.0903 - val_loss: 0.0641
Epoch 29/300
5/5 [==============================] - 1s 291ms/step - loss: 0.0899 - val_loss: 0.0660
Epoch 30/300
5/5 [==============================] - 1s 273ms/step - loss: 0.0885 - val_loss: 0.0584
Epoch 31/300
5/5 [==============================] - 2s 314ms/step - loss: 0.0881 - val_loss: 0.0593
Epoch 32/300
5/5 [==============================] - 2s 312ms/step - loss: 0.0896 - val_loss: 0.0569
Epoch 33/300
5/5 [==============================] - 2s 308ms/step - loss: 0.0899 - val_loss: 0.0607
Epoch 34/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0909 - val_loss: 0.0546
Epoch 35/300
5/5 [==============================] - 2s 333ms/step - loss: 0.0934 - val_loss: 0.0601
Epoch 36/300
5/5 [==============================] - 2s 333ms/step - loss: 0.0900 - val_loss: 0.0716
Epoch 37/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0905 - val_loss: 0.0585
Epoch 38/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0893 - val_loss: 0.0731
Epoch 39/300
5/5 [==============================] - 2s 369ms/step - loss: 0.0886 - val_loss: 0.0552
Epoch 40/300
5/5 [==============================] - 2s 313ms/step - loss: 0.0883 - val_loss: 0.0563
Epoch 41/300
5/5 [==============================] - 1s 293ms/step - loss: 0.0890 - val_loss: 0.0631
Epoch 42/300
5/5 [==============================] - 2s 306ms/step - loss: 0.0876 - val_loss: 0.0577
Epoch 43/300
5/5 [==============================] - 2s 299ms/step - loss: 0.0858 - val_loss: 0.0623
Epoch 44/300
5/5 [==============================] - 1s 291ms/step - loss: 0.0883 - val_loss: 0.0586
Epoch 45/300
5/5 [==============================] - 1s 289ms/step - loss: 0.0870 - val_loss: 0.0551
Epoch 46/300
5/5 [==============================] - 1s 287ms/step - loss: 0.0899 - val_loss: 0.0592
Epoch 47/300
5/5 [==============================] - 1s 264ms/step - loss: 0.0892 - val_loss: 0.0573
Epoch 48/300
5/5 [==============================] - 1s 270ms/step - loss: 0.0865 - val_loss: 0.0590
Epoch 49/300
5/5 [==============================] - 1s 267ms/step - loss: 0.0885 - val_loss: 0.0564
Epoch 50/300
5/5 [==============================] - 1s 269ms/step - loss: 0.0874 - val_loss: 0.0546
Epoch 51/300
5/5 [==============================] - 1s 270ms/step - loss: 0.0875 - val_loss: 0.0550
Epoch 52/300
5/5 [==============================] - 1s 271ms/step - loss: 0.0868 - val_loss: 0.0613
Epoch 53/300
5/5 [==============================] - 1s 277ms/step - loss: 0.0902 - val_loss: 0.0560
Epoch 54/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0881 - val_loss: 0.0524
Epoch 55/300
5/5 [==============================] - 2s 300ms/step - loss: 0.0877 - val_loss: 0.0519
Epoch 56/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0876 - val_loss: 0.0557
Epoch 57/300
5/5 [==============================] - 1s 274ms/step - loss: 0.0874 - val_loss: 0.0610
Epoch 58/300
5/5 [==============================] - 1s 288ms/step - loss: 0.0913 - val_loss: 0.0584
Epoch 59/300
5/5 [==============================] - 1s 294ms/step - loss: 0.0889 - val_loss: 0.0546
Epoch 60/300
5/5 [==============================] - 2s 313ms/step - loss: 0.0857 - val_loss: 0.0541
Epoch 61/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0872 - val_loss: 0.0535
Epoch 62/300
5/5 [==============================] - 2s 383ms/step - loss: 0.0882 - val_loss: 0.0578
Epoch 63/300
5/5 [==============================] - 1s 275ms/step - loss: 0.0863 - val_loss: 0.0576
Epoch 64/300
5/5 [==============================] - 1s 272ms/step - loss: 0.0883 - val_loss: 0.0591
Epoch 65/300
5/5 [==============================] - 1s 295ms/step - loss: 0.0877 - val_loss: 0.0565
Epoch 66/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0869 - val_loss: 0.0550
Epoch 67/300
5/5 [==============================] - 2s 322ms/step - loss: 0.0882 - val_loss: 0.0571
Epoch 68/300
5/5 [==============================] - 2s 408ms/step - loss: 0.0858 - val_loss: 0.0552
Epoch 69/300
5/5 [==============================] - 2s 394ms/step - loss: 0.0866 - val_loss: 0.0556
Epoch 70/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0874 - val_loss: 0.0548
Epoch 71/300
5/5 [==============================] - 2s 305ms/step - loss: 0.0875 - val_loss: 0.0580
Epoch 72/300
5/5 [==============================] - 2s 322ms/step - loss: 0.0879 - val_loss: 0.0553
Epoch 73/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0870 - val_loss: 0.0584
Epoch 74/300
5/5 [==============================] - 2s 305ms/step - loss: 0.0926 - val_loss: 0.0734
Epoch 75/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0872 - val_loss: 0.0558
Epoch 76/300
5/5 [==============================] - 2s 299ms/step - loss: 0.0868 - val_loss: 0.0584
Epoch 77/300
5/5 [==============================] - 2s 311ms/step - loss: 0.0863 - val_loss: 0.0710
Epoch 78/300
5/5 [==============================] - 1s 296ms/step - loss: 0.0866 - val_loss: 0.0588
Epoch 79/300
5/5 [==============================] - 2s 316ms/step - loss: 0.0872 - val_loss: 0.0568
Epoch 80/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0883 - val_loss: 0.0607
Epoch 81/300
5/5 [==============================] - 2s 466ms/step - loss: 0.0870 - val_loss: 0.0622
Epoch 82/300
5/5 [==============================] - 2s 423ms/step - loss: 0.0865 - val_loss: 0.0584
Epoch 83/300
5/5 [==============================] - 2s 418ms/step - loss: 0.0867 - val_loss: 0.0571
Epoch 84/300
5/5 [==============================] - 2s 358ms/step - loss: 0.0870 - val_loss: 0.0603
Epoch 85/300
5/5 [==============================] - 2s 393ms/step - loss: 0.0883 - val_loss: 0.0613
Epoch 86/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0888 - val_loss: 0.0602
Epoch 87/300
5/5 [==============================] - 2s 387ms/step - loss: 0.0867 - val_loss: 0.0615
Epoch 88/300
5/5 [==============================] - 2s 352ms/step - loss: 0.0861 - val_loss: 0.0574
Epoch 89/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0868 - val_loss: 0.0564
Epoch 90/300
5/5 [==============================] - 2s 444ms/step - loss: 0.0878 - val_loss: 0.0558
Epoch 91/300
5/5 [==============================] - 2s 421ms/step - loss: 0.0866 - val_loss: 0.0544
Epoch 92/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0888 - val_loss: 0.0537
Epoch 93/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0889 - val_loss: 0.0557
Epoch 94/300
5/5 [==============================] - 2s 374ms/step - loss: 0.0884 - val_loss: 0.0586
Epoch 95/300
5/5 [==============================] - 2s 392ms/step - loss: 0.0864 - val_loss: 0.0571
Epoch 96/300
5/5 [==============================] - 3s 579ms/step - loss: 0.0883 - val_loss: 0.0570
Epoch 97/300
5/5 [==============================] - 3s 477ms/step - loss: 0.0881 - val_loss: 0.0622
Epoch 98/300
5/5 [==============================] - 3s 533ms/step - loss: 0.0865 - val_loss: 0.0563
Epoch 99/300
5/5 [==============================] - 2s 501ms/step - loss: 0.0876 - val_loss: 0.0544
Epoch 100/300
5/5 [==============================] - 3s 594ms/step - loss: 0.0864 - val_loss: 0.0555
Epoch 101/300
5/5 [==============================] - 2s 476ms/step - loss: 0.0918 - val_loss: 0.0585
Epoch 102/300
5/5 [==============================] - 2s 441ms/step - loss: 0.0909 - val_loss: 0.0691
Epoch 103/300
5/5 [==============================] - 2s 452ms/step - loss: 0.0906 - val_loss: 0.0664
Epoch 104/300
5/5 [==============================] - 2s 429ms/step - loss: 0.0885 - val_loss: 0.0652
Epoch 105/300
5/5 [==============================] - 2s 476ms/step - loss: 0.0859 - val_loss: 0.0682
Epoch 106/300
5/5 [==============================] - 2s 398ms/step - loss: 0.0881 - val_loss: 0.0664
Epoch 107/300
5/5 [==============================] - 2s 397ms/step - loss: 0.0873 - val_loss: 0.0587
Epoch 108/300
5/5 [==============================] - 2s 421ms/step - loss: 0.0878 - val_loss: 0.0524
Epoch 109/300
5/5 [==============================] - 2s 403ms/step - loss: 0.0908 - val_loss: 0.0521
Epoch 110/300
5/5 [==============================] - 2s 445ms/step - loss: 0.0873 - val_loss: 0.0549
Epoch 111/300
5/5 [==============================] - 2s 442ms/step - loss: 0.0867 - val_loss: 0.0638
Epoch 112/300
5/5 [==============================] - 2s 401ms/step - loss: 0.0884 - val_loss: 0.0573
Epoch 113/300
5/5 [==============================] - 2s 428ms/step - loss: 0.0855 - val_loss: 0.0556
Epoch 114/300
5/5 [==============================] - 2s 393ms/step - loss: 0.0846 - val_loss: 0.0563
Epoch 115/300
5/5 [==============================] - 2s 383ms/step - loss: 0.0852 - val_loss: 0.0593
Epoch 116/300
5/5 [==============================] - 2s 385ms/step - loss: 0.0856 - val_loss: 0.0605
Epoch 117/300
5/5 [==============================] - 2s 391ms/step - loss: 0.0848 - val_loss: 0.0629
Epoch 118/300
5/5 [==============================] - 2s 379ms/step - loss: 0.0846 - val_loss: 0.0638
Epoch 119/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0849 - val_loss: 0.0612
Epoch 120/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0843 - val_loss: 0.0572
Epoch 121/300
5/5 [==============================] - 2s 418ms/step - loss: 0.0835 - val_loss: 0.0567
Epoch 122/300
5/5 [==============================] - 2s 358ms/step - loss: 0.0865 - val_loss: 0.0559
Epoch 123/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0828 - val_loss: 0.0549
Epoch 124/300
5/5 [==============================] - 2s 359ms/step - loss: 0.0863 - val_loss: 0.0609
Epoch 125/300
5/5 [==============================] - 2s 356ms/step - loss: 0.0886 - val_loss: 0.0555
Epoch 126/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0863 - val_loss: 0.0637
Epoch 127/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0869 - val_loss: 0.0889
Epoch 128/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0863 - val_loss: 0.0541
Epoch 129/300
5/5 [==============================] - 2s 371ms/step - loss: 0.0859 - val_loss: 0.0522
Epoch 130/300
5/5 [==============================] - 2s 364ms/step - loss: 0.0876 - val_loss: 0.0573
Epoch 131/300
5/5 [==============================] - 2s 378ms/step - loss: 0.0864 - val_loss: 0.0683
Epoch 132/300
5/5 [==============================] - 2s 378ms/step - loss: 0.0862 - val_loss: 0.0700
Epoch 133/300
5/5 [==============================] - 2s 369ms/step - loss: 0.0884 - val_loss: 0.0646
Epoch 134/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0858 - val_loss: 0.0687
Epoch 135/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0850 - val_loss: 0.0563
Epoch 136/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0849 - val_loss: 0.0531
Epoch 137/300
5/5 [==============================] - 2s 358ms/step - loss: 0.0946 - val_loss: 0.0528
Epoch 138/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0879 - val_loss: 0.0830
Epoch 139/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0903 - val_loss: 0.0556
Epoch 140/300
5/5 [==============================] - 2s 364ms/step - loss: 0.0879 - val_loss: 0.0541
Epoch 141/300
5/5 [==============================] - 2s 379ms/step - loss: 0.0900 - val_loss: 0.0787
Epoch 142/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0886 - val_loss: 0.0597
Epoch 143/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0862 - val_loss: 0.0585
Epoch 144/300
5/5 [==============================] - 2s 377ms/step - loss: 0.0895 - val_loss: 0.0844
Epoch 145/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0917 - val_loss: 0.0628
Epoch 146/300
5/5 [==============================] - 2s 378ms/step - loss: 0.0899 - val_loss: 0.0592
Epoch 147/300
5/5 [==============================] - 2s 504ms/step - loss: 0.0899 - val_loss: 0.0569
Epoch 148/300
5/5 [==============================] - 2s 380ms/step - loss: 0.0872 - val_loss: 0.0618
Epoch 149/300
5/5 [==============================] - 2s 391ms/step - loss: 0.0885 - val_loss: 0.0658
Epoch 150/300
5/5 [==============================] - 2s 401ms/step - loss: 0.0918 - val_loss: 0.0552
Epoch 151/300
5/5 [==============================] - 2s 408ms/step - loss: 0.0913 - val_loss: 0.0785
Epoch 152/300
5/5 [==============================] - 2s 413ms/step - loss: 0.0960 - val_loss: 0.0609
Epoch 153/300
5/5 [==============================] - 2s 488ms/step - loss: 0.0899 - val_loss: 0.0641
Epoch 154/300
5/5 [==============================] - 2s 499ms/step - loss: 0.0873 - val_loss: 0.0621
Epoch 155/300
5/5 [==============================] - 2s 385ms/step - loss: 0.0867 - val_loss: 0.0742
Epoch 156/300
5/5 [==============================] - 2s 384ms/step - loss: 0.0869 - val_loss: 0.0611
Epoch 157/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0877 - val_loss: 0.0621
Epoch 158/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0881 - val_loss: 0.0633
Epoch 159/300
5/5 [==============================] - 2s 375ms/step - loss: 0.0871 - val_loss: 0.0595
Epoch 160/300
5/5 [==============================] - 2s 432ms/step - loss: 0.0863 - val_loss: 0.0566
Epoch 161/300
5/5 [==============================] - 2s 394ms/step - loss: 0.0875 - val_loss: 0.0606
Epoch 162/300
5/5 [==============================] - 2s 368ms/step - loss: 0.0872 - val_loss: 0.0583
Epoch 163/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0870 - val_loss: 0.0556
Epoch 164/300
5/5 [==============================] - 2s 427ms/step - loss: 0.0877 - val_loss: 0.0612
Epoch 165/300
5/5 [==============================] - 2s 378ms/step - loss: 0.0866 - val_loss: 0.0600
Epoch 166/300
5/5 [==============================] - 2s 492ms/step - loss: 0.0866 - val_loss: 0.0599
Epoch 167/300
5/5 [==============================] - 2s 467ms/step - loss: 0.0874 - val_loss: 0.0660
Epoch 168/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0866 - val_loss: 0.0592
Epoch 169/300
5/5 [==============================] - 2s 398ms/step - loss: 0.0871 - val_loss: 0.0578
Epoch 170/300
5/5 [==============================] - 2s 410ms/step - loss: 0.0865 - val_loss: 0.0568
Epoch 171/300
5/5 [==============================] - 2s 468ms/step - loss: 0.0868 - val_loss: 0.0611
Epoch 172/300
5/5 [==============================] - 2s 469ms/step - loss: 0.0852 - val_loss: 0.0610
Epoch 173/300
5/5 [==============================] - 2s 411ms/step - loss: 0.0870 - val_loss: 0.0617
Epoch 174/300
5/5 [==============================] - 2s 375ms/step - loss: 0.0859 - val_loss: 0.0581
Epoch 175/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0853 - val_loss: 0.0565
Epoch 176/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0851 - val_loss: 0.0572
Epoch 177/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0860 - val_loss: 0.0555
Epoch 178/300
5/5 [==============================] - 2s 332ms/step - loss: 0.0854 - val_loss: 0.0539
Epoch 179/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0863 - val_loss: 0.0548
Epoch 180/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0862 - val_loss: 0.0536
Epoch 181/300
5/5 [==============================] - 2s 394ms/step - loss: 0.0851 - val_loss: 0.0549
Epoch 182/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0848 - val_loss: 0.0547
Epoch 183/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0860 - val_loss: 0.0551
Epoch 184/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0858 - val_loss: 0.0583
Epoch 185/300
5/5 [==============================] - 2s 347ms/step - loss: 0.0877 - val_loss: 0.0597
Epoch 186/300
5/5 [==============================] - 2s 422ms/step - loss: 0.0870 - val_loss: 0.0728
Epoch 187/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0857 - val_loss: 0.0647
Epoch 188/300
5/5 [==============================] - 2s 334ms/step - loss: 0.0856 - val_loss: 0.0623
Epoch 189/300
5/5 [==============================] - 2s 366ms/step - loss: 0.0856 - val_loss: 0.0595
Epoch 190/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0876 - val_loss: 0.0546
Epoch 191/300
5/5 [==============================] - 2s 346ms/step - loss: 0.0850 - val_loss: 0.0541
Epoch 192/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0863 - val_loss: 0.0563
Epoch 193/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0861 - val_loss: 0.0562
Epoch 194/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0843 - val_loss: 0.0571
Epoch 195/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0834 - val_loss: 0.0564
Epoch 196/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0848 - val_loss: 0.0584
Epoch 197/300
5/5 [==============================] - 2s 420ms/step - loss: 0.0843 - val_loss: 0.0722
Epoch 198/300
5/5 [==============================] - 2s 429ms/step - loss: 0.0846 - val_loss: 0.0570
Epoch 199/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0930 - val_loss: 0.0813
Epoch 200/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0957 - val_loss: 0.0562
Epoch 201/300
5/5 [==============================] - 2s 439ms/step - loss: 0.0869 - val_loss: 0.0738
Epoch 202/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0880 - val_loss: 0.0631
Epoch 203/300
5/5 [==============================] - 2s 356ms/step - loss: 0.0862 - val_loss: 0.0668
Epoch 204/300
5/5 [==============================] - 2s 486ms/step - loss: 0.0876 - val_loss: 0.0704
Epoch 205/300
5/5 [==============================] - 2s 417ms/step - loss: 0.0901 - val_loss: 0.0926
Epoch 206/300
5/5 [==============================] - 2s 370ms/step - loss: 0.0925 - val_loss: 0.0622
Epoch 207/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0878 - val_loss: 0.0545
Epoch 208/300
5/5 [==============================] - 2s 414ms/step - loss: 0.0879 - val_loss: 0.0635
Epoch 209/300
5/5 [==============================] - 2s 407ms/step - loss: 0.0869 - val_loss: 0.0558
Epoch 210/300
5/5 [==============================] - 2s 400ms/step - loss: 0.0865 - val_loss: 0.0552
Epoch 211/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0863 - val_loss: 0.0572
Epoch 212/300
5/5 [==============================] - 2s 412ms/step - loss: 0.0847 - val_loss: 0.0554
Epoch 213/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0849 - val_loss: 0.0560
Epoch 214/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0855 - val_loss: 0.0555
Epoch 215/300
5/5 [==============================] - 2s 476ms/step - loss: 0.0837 - val_loss: 0.0598
Epoch 216/300
5/5 [==============================] - 2s 364ms/step - loss: 0.0826 - val_loss: 0.0623
Epoch 217/300
5/5 [==============================] - 2s 347ms/step - loss: 0.0812 - val_loss: 0.0585
Epoch 218/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0813 - val_loss: 0.0564
Epoch 219/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0825 - val_loss: 0.0554
Epoch 220/300
5/5 [==============================] - 2s 482ms/step - loss: 0.0800 - val_loss: 0.0559
Epoch 221/300
5/5 [==============================] - 2s 419ms/step - loss: 0.0821 - val_loss: 0.0570
Epoch 222/300
5/5 [==============================] - 2s 451ms/step - loss: 0.0795 - val_loss: 0.0570
Epoch 223/300
5/5 [==============================] - 2s 400ms/step - loss: 0.0798 - val_loss: 0.0627
Epoch 224/300
5/5 [==============================] - 2s 379ms/step - loss: 0.0810 - val_loss: 0.0584
Epoch 225/300
5/5 [==============================] - 2s 412ms/step - loss: 0.0801 - val_loss: 0.0594
Epoch 226/300
5/5 [==============================] - 2s 397ms/step - loss: 0.0805 - val_loss: 0.0559
Epoch 227/300
5/5 [==============================] - 2s 348ms/step - loss: 0.0822 - val_loss: 0.0587
Epoch 228/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0821 - val_loss: 0.0598
Epoch 229/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0818 - val_loss: 0.0577
Epoch 230/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0842 - val_loss: 0.0541
Epoch 231/300
5/5 [==============================] - 2s 329ms/step - loss: 0.0792 - val_loss: 0.0562
Epoch 232/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0856 - val_loss: 0.0546
Epoch 233/300
5/5 [==============================] - 2s 333ms/step - loss: 0.0808 - val_loss: 0.0621
Epoch 234/300
5/5 [==============================] - 2s 414ms/step - loss: 0.0857 - val_loss: 0.0618
Epoch 235/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0884 - val_loss: 0.0584
Epoch 236/300
5/5 [==============================] - 2s 404ms/step - loss: 0.0846 - val_loss: 0.0627
Epoch 237/300
5/5 [==============================] - 2s 488ms/step - loss: 0.0861 - val_loss: 0.0557
Epoch 238/300
5/5 [==============================] - 2s 402ms/step - loss: 0.0839 - val_loss: 0.0569
Epoch 239/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0826 - val_loss: 0.0611
Epoch 240/300
5/5 [==============================] - 2s 393ms/step - loss: 0.0839 - val_loss: 0.0558
Epoch 241/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0840 - val_loss: 0.0735
Epoch 242/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0854 - val_loss: 0.0541
Epoch 243/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0855 - val_loss: 0.0656
Epoch 244/300
5/5 [==============================] - 2s 385ms/step - loss: 0.0816 - val_loss: 0.0543
Epoch 245/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0832 - val_loss: 0.0563
Epoch 246/300
5/5 [==============================] - 2s 364ms/step - loss: 0.0847 - val_loss: 0.0526
Epoch 247/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0834 - val_loss: 0.0868
Epoch 248/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0815 - val_loss: 0.0673
Epoch 249/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0818 - val_loss: 0.0598
Epoch 250/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0856 - val_loss: 0.0769
Epoch 251/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0837 - val_loss: 0.0697
Epoch 252/300
5/5 [==============================] - 2s 372ms/step - loss: 0.0802 - val_loss: 0.0550
Epoch 253/300
5/5 [==============================] - 2s 454ms/step - loss: 0.0776 - val_loss: 0.0570
Epoch 254/300
5/5 [==============================] - 2s 467ms/step - loss: 0.0781 - val_loss: 0.0605
Epoch 255/300
5/5 [==============================] - 2s 426ms/step - loss: 0.0809 - val_loss: 0.0533
Epoch 256/300
5/5 [==============================] - 2s 375ms/step - loss: 0.0847 - val_loss: 0.0590
Epoch 257/300
5/5 [==============================] - 2s 374ms/step - loss: 0.0821 - val_loss: 0.0537
Epoch 258/300
5/5 [==============================] - 2s 359ms/step - loss: 0.0823 - val_loss: 0.0530
Epoch 259/300
5/5 [==============================] - 2s 357ms/step - loss: 0.0788 - val_loss: 0.0707
Epoch 260/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0765 - val_loss: 0.0596
Epoch 261/300
5/5 [==============================] - 2s 339ms/step - loss: 0.0810 - val_loss: 0.0573
Epoch 262/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0762 - val_loss: 0.0550
Epoch 263/300
5/5 [==============================] - 2s 372ms/step - loss: 0.0738 - val_loss: 0.0556
Epoch 264/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0727 - val_loss: 0.0559
Epoch 265/300
5/5 [==============================] - 2s 407ms/step - loss: 0.0742 - val_loss: 0.0535
Epoch 266/300
5/5 [==============================] - 2s 402ms/step - loss: 0.0703 - val_loss: 0.0726
Epoch 267/300
5/5 [==============================] - 2s 391ms/step - loss: 0.0714 - val_loss: 0.0699
Epoch 268/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0802 - val_loss: 0.0646
Epoch 269/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0826 - val_loss: 0.0529
Epoch 270/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0724 - val_loss: 0.0797
Epoch 271/300
5/5 [==============================] - 2s 386ms/step - loss: 0.0702 - val_loss: 0.0544
Epoch 272/300
5/5 [==============================] - 2s 356ms/step - loss: 0.0639 - val_loss: 0.0570
Epoch 273/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0683 - val_loss: 0.0590
Epoch 274/300
5/5 [==============================] - 2s 334ms/step - loss: 0.0660 - val_loss: 0.0583
Epoch 275/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0725 - val_loss: 0.0614
Epoch 276/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0713 - val_loss: 0.0617
Epoch 277/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0849 - val_loss: 0.0568
Epoch 278/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0811 - val_loss: 0.0762
Epoch 279/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0724 - val_loss: 0.0611
Epoch 280/300
5/5 [==============================] - 2s 335ms/step - loss: 0.0700 - val_loss: 0.0556
Epoch 281/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0674 - val_loss: 0.0551
Epoch 282/300
5/5 [==============================] - 2s 357ms/step - loss: 0.0666 - val_loss: 0.0588
Epoch 283/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0713 - val_loss: 0.0690
Epoch 284/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0691 - val_loss: 0.0515
Epoch 285/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0607 - val_loss: 0.0580
Epoch 286/300
5/5 [==============================] - 2s 358ms/step - loss: 0.0686 - val_loss: 0.0659
Epoch 287/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0821 - val_loss: 0.0516
Epoch 288/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0666 - val_loss: 0.0567
Epoch 289/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0671 - val_loss: 0.0500
Epoch 290/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0584 - val_loss: 0.0614
Epoch 291/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0620 - val_loss: 0.0604
Epoch 292/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0694 - val_loss: 0.0674
Epoch 293/300
5/5 [==============================] - 2s 352ms/step - loss: 0.0649 - val_loss: 0.0529
Epoch 294/300
5/5 [==============================] - 2s 352ms/step - loss: 0.0610 - val_loss: 0.0598
Epoch 295/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0609 - val_loss: 0.0601
Epoch 296/300
5/5 [==============================] - 2s 333ms/step - loss: 0.0538 - val_loss: 0.0647
Epoch 297/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0546 - val_loss: 0.0649
Epoch 298/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0518 - val_loss: 0.0686
Epoch 299/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0775 - val_loss: 0.0516
Epoch 300/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0681 - val_loss: 0.0715
Epoch 1/300
5/5 [==============================] - 35s 2s/step - loss: 0.4123 - val_loss: 0.4630
Epoch 2/300
5/5 [==============================] - 2s 425ms/step - loss: 0.1900 - val_loss: 0.1521
Epoch 3/300
5/5 [==============================] - 2s 496ms/step - loss: 0.1639 - val_loss: 0.2360
Epoch 4/300
5/5 [==============================] - 2s 475ms/step - loss: 0.1421 - val_loss: 0.2454
Epoch 5/300
5/5 [==============================] - 3s 525ms/step - loss: 0.1433 - val_loss: 0.2308
Epoch 6/300
5/5 [==============================] - 2s 444ms/step - loss: 0.1356 - val_loss: 0.2354
Epoch 7/300
5/5 [==============================] - 2s 355ms/step - loss: 0.1324 - val_loss: 0.2269
Epoch 8/300
5/5 [==============================] - 2s 427ms/step - loss: 0.1175 - val_loss: 0.0503
Epoch 9/300
5/5 [==============================] - 2s 431ms/step - loss: 0.1028 - val_loss: 0.0660
Epoch 10/300
5/5 [==============================] - 2s 463ms/step - loss: 0.0927 - val_loss: 0.0951
Epoch 11/300
5/5 [==============================] - 2s 445ms/step - loss: 0.0887 - val_loss: 0.0650
Epoch 12/300
5/5 [==============================] - 2s 407ms/step - loss: 0.0881 - val_loss: 0.0707
Epoch 13/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0852 - val_loss: 0.0538
Epoch 14/300
5/5 [==============================] - 2s 392ms/step - loss: 0.0838 - val_loss: 0.0695
Epoch 15/300
5/5 [==============================] - 2s 428ms/step - loss: 0.0841 - val_loss: 0.0519
Epoch 16/300
5/5 [==============================] - 2s 386ms/step - loss: 0.0846 - val_loss: 0.0516
Epoch 17/300
5/5 [==============================] - 2s 358ms/step - loss: 0.0863 - val_loss: 0.0541
Epoch 18/300
5/5 [==============================] - 2s 344ms/step - loss: 0.0869 - val_loss: 0.0497
Epoch 19/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0870 - val_loss: 0.0569
Epoch 20/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0847 - val_loss: 0.0493
Epoch 21/300
5/5 [==============================] - 2s 440ms/step - loss: 0.0833 - val_loss: 0.0548
Epoch 22/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0843 - val_loss: 0.0674
Epoch 23/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0864 - val_loss: 0.0547
Epoch 24/300
5/5 [==============================] - 2s 368ms/step - loss: 0.0862 - val_loss: 0.0503
Epoch 25/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0838 - val_loss: 0.0518
Epoch 26/300
5/5 [==============================] - 2s 346ms/step - loss: 0.0845 - val_loss: 0.0595
Epoch 27/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0869 - val_loss: 0.0500
Epoch 28/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0870 - val_loss: 0.0538
Epoch 29/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0876 - val_loss: 0.0714
Epoch 30/300
5/5 [==============================] - 2s 354ms/step - loss: 0.0905 - val_loss: 0.0490
Epoch 31/300
5/5 [==============================] - 2s 369ms/step - loss: 0.0883 - val_loss: 0.0523
Epoch 32/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0868 - val_loss: 0.0710
Epoch 33/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0888 - val_loss: 0.0501
Epoch 34/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0840 - val_loss: 0.0553
Epoch 35/300
5/5 [==============================] - 2s 511ms/step - loss: 0.0855 - val_loss: 0.0609
Epoch 36/300
5/5 [==============================] - 2s 396ms/step - loss: 0.0835 - val_loss: 0.0529
Epoch 37/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0836 - val_loss: 0.0543
Epoch 38/300
5/5 [==============================] - 2s 346ms/step - loss: 0.0845 - val_loss: 0.0506
Epoch 39/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0837 - val_loss: 0.0544
Epoch 40/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0844 - val_loss: 0.0539
Epoch 41/300
5/5 [==============================] - 2s 335ms/step - loss: 0.0842 - val_loss: 0.0518
Epoch 42/300
5/5 [==============================] - 2s 404ms/step - loss: 0.0839 - val_loss: 0.0516
Epoch 43/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0829 - val_loss: 0.0604
Epoch 44/300
5/5 [==============================] - 2s 397ms/step - loss: 0.0849 - val_loss: 0.0576
Epoch 45/300
5/5 [==============================] - 2s 360ms/step - loss: 0.0845 - val_loss: 0.0486
Epoch 46/300
5/5 [==============================] - 2s 410ms/step - loss: 0.0841 - val_loss: 0.0489
Epoch 47/300
5/5 [==============================] - 2s 463ms/step - loss: 0.0830 - val_loss: 0.0521
Epoch 48/300
5/5 [==============================] - 3s 593ms/step - loss: 0.0841 - val_loss: 0.0513
Epoch 49/300
5/5 [==============================] - 3s 551ms/step - loss: 0.0844 - val_loss: 0.0541
Epoch 50/300
5/5 [==============================] - 4s 617ms/step - loss: 0.0840 - val_loss: 0.0506
Epoch 51/300
5/5 [==============================] - 3s 548ms/step - loss: 0.0862 - val_loss: 0.0518
Epoch 52/300
5/5 [==============================] - 3s 504ms/step - loss: 0.0871 - val_loss: 0.0661
Epoch 53/300
5/5 [==============================] - 3s 506ms/step - loss: 0.0861 - val_loss: 0.0516
Epoch 54/300
5/5 [==============================] - 3s 561ms/step - loss: 0.0863 - val_loss: 0.0548
Epoch 55/300
5/5 [==============================] - 2s 503ms/step - loss: 0.0851 - val_loss: 0.0566
Epoch 56/300
5/5 [==============================] - 2s 427ms/step - loss: 0.0854 - val_loss: 0.0571
Epoch 57/300
5/5 [==============================] - 2s 497ms/step - loss: 0.0833 - val_loss: 0.0530
Epoch 58/300
5/5 [==============================] - 2s 420ms/step - loss: 0.0844 - val_loss: 0.0634
Epoch 59/300
5/5 [==============================] - 2s 476ms/step - loss: 0.0832 - val_loss: 0.0562
Epoch 60/300
5/5 [==============================] - 2s 463ms/step - loss: 0.0865 - val_loss: 0.0552
Epoch 61/300
5/5 [==============================] - 2s 425ms/step - loss: 0.0849 - val_loss: 0.0595
Epoch 62/300
5/5 [==============================] - 2s 437ms/step - loss: 0.0835 - val_loss: 0.0611
Epoch 63/300
5/5 [==============================] - 2s 476ms/step - loss: 0.0828 - val_loss: 0.0566
Epoch 64/300
5/5 [==============================] - 2s 474ms/step - loss: 0.0852 - val_loss: 0.0539
Epoch 65/300
5/5 [==============================] - 2s 410ms/step - loss: 0.0855 - val_loss: 0.0521
Epoch 66/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0838 - val_loss: 0.0626
Epoch 67/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0827 - val_loss: 0.0594
Epoch 68/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0833 - val_loss: 0.0542
Epoch 69/300
5/5 [==============================] - 2s 374ms/step - loss: 0.0815 - val_loss: 0.0498
Epoch 70/300
5/5 [==============================] - 2s 300ms/step - loss: 0.0809 - val_loss: 0.0563
Epoch 71/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0852 - val_loss: 0.0537
Epoch 72/300
5/5 [==============================] - 2s 328ms/step - loss: 0.0860 - val_loss: 0.0480
Epoch 73/300
5/5 [==============================] - 2s 325ms/step - loss: 0.0861 - val_loss: 0.0473
Epoch 74/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0867 - val_loss: 0.0544
Epoch 75/300
5/5 [==============================] - 2s 314ms/step - loss: 0.0881 - val_loss: 0.0503
Epoch 76/300
5/5 [==============================] - 1s 306ms/step - loss: 0.0887 - val_loss: 0.0521
Epoch 77/300
5/5 [==============================] - 2s 318ms/step - loss: 0.0845 - val_loss: 0.0546
Epoch 78/300
5/5 [==============================] - 2s 310ms/step - loss: 0.0856 - val_loss: 0.0556
Epoch 79/300
5/5 [==============================] - 2s 305ms/step - loss: 0.0871 - val_loss: 0.0623
Epoch 80/300
5/5 [==============================] - 1s 292ms/step - loss: 0.0851 - val_loss: 0.0545
Epoch 81/300
5/5 [==============================] - 2s 315ms/step - loss: 0.0843 - val_loss: 0.0575
Epoch 82/300
5/5 [==============================] - 2s 311ms/step - loss: 0.0825 - val_loss: 0.0645
Epoch 83/300
5/5 [==============================] - 2s 329ms/step - loss: 0.0833 - val_loss: 0.0553
Epoch 84/300
5/5 [==============================] - 1s 294ms/step - loss: 0.0878 - val_loss: 0.0622
Epoch 85/300
5/5 [==============================] - 1s 304ms/step - loss: 0.0886 - val_loss: 0.0578
Epoch 86/300
5/5 [==============================] - 2s 314ms/step - loss: 0.0868 - val_loss: 0.0507
Epoch 87/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0894 - val_loss: 0.0490
Epoch 88/300
5/5 [==============================] - 1s 296ms/step - loss: 0.0873 - val_loss: 0.0566
Epoch 89/300
5/5 [==============================] - 1s 299ms/step - loss: 0.0854 - val_loss: 0.0582
Epoch 90/300
5/5 [==============================] - 2s 311ms/step - loss: 0.0825 - val_loss: 0.0589
Epoch 91/300
5/5 [==============================] - 2s 322ms/step - loss: 0.0834 - val_loss: 0.0499
Epoch 92/300
5/5 [==============================] - 2s 312ms/step - loss: 0.0826 - val_loss: 0.0532
Epoch 93/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0815 - val_loss: 0.0530
Epoch 94/300
5/5 [==============================] - 2s 312ms/step - loss: 0.0811 - val_loss: 0.0570
Epoch 95/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0816 - val_loss: 0.0601
Epoch 96/300
5/5 [==============================] - 2s 402ms/step - loss: 0.0831 - val_loss: 0.0509
Epoch 97/300
5/5 [==============================] - 2s 418ms/step - loss: 0.0848 - val_loss: 0.0522
Epoch 98/300
5/5 [==============================] - 2s 371ms/step - loss: 0.0845 - val_loss: 0.0574
Epoch 99/300
5/5 [==============================] - 2s 356ms/step - loss: 0.0844 - val_loss: 0.0522
Epoch 100/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0821 - val_loss: 0.0517
Epoch 101/300
5/5 [==============================] - 2s 389ms/step - loss: 0.0806 - val_loss: 0.0565
Epoch 102/300
5/5 [==============================] - 2s 329ms/step - loss: 0.0820 - val_loss: 0.0606
Epoch 103/300
5/5 [==============================] - 1s 304ms/step - loss: 0.0793 - val_loss: 0.0493
Epoch 104/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0773 - val_loss: 0.0463
Epoch 105/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0752 - val_loss: 0.0495
Epoch 106/300
5/5 [==============================] - 2s 329ms/step - loss: 0.0777 - val_loss: 0.0467
Epoch 107/300
5/5 [==============================] - 2s 508ms/step - loss: 0.0847 - val_loss: 0.0537
Epoch 108/300
5/5 [==============================] - 2s 459ms/step - loss: 0.0805 - val_loss: 0.0588
Epoch 109/300
5/5 [==============================] - 2s 398ms/step - loss: 0.0849 - val_loss: 0.0499
Epoch 110/300
5/5 [==============================] - 2s 400ms/step - loss: 0.0832 - val_loss: 0.0479
Epoch 111/300
5/5 [==============================] - 2s 384ms/step - loss: 0.0805 - val_loss: 0.0609
Epoch 112/300
5/5 [==============================] - 2s 404ms/step - loss: 0.0777 - val_loss: 0.0503
Epoch 113/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0789 - val_loss: 0.0498
Epoch 114/300
5/5 [==============================] - 2s 313ms/step - loss: 0.0789 - val_loss: 0.0510
Epoch 115/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0748 - val_loss: 0.0512
Epoch 116/300
5/5 [==============================] - 1s 295ms/step - loss: 0.0737 - val_loss: 0.0483
Epoch 117/300
5/5 [==============================] - 1s 294ms/step - loss: 0.0774 - val_loss: 0.0477
Epoch 118/300
5/5 [==============================] - 1s 300ms/step - loss: 0.0759 - val_loss: 0.0520
Epoch 119/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0798 - val_loss: 0.0497
Epoch 120/300
5/5 [==============================] - 2s 380ms/step - loss: 0.0789 - val_loss: 0.0843
Epoch 121/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0775 - val_loss: 0.0528
Epoch 122/300
5/5 [==============================] - 1s 304ms/step - loss: 0.0770 - val_loss: 0.0488
Epoch 123/300
5/5 [==============================] - 2s 307ms/step - loss: 0.0797 - val_loss: 0.0508
Epoch 124/300
5/5 [==============================] - 2s 303ms/step - loss: 0.0754 - val_loss: 0.0511
Epoch 125/300
5/5 [==============================] - 2s 397ms/step - loss: 0.0754 - val_loss: 0.0475
Epoch 126/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0780 - val_loss: 0.0458
Epoch 127/300
5/5 [==============================] - 2s 337ms/step - loss: 0.0773 - val_loss: 0.0461
Epoch 128/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0758 - val_loss: 0.0466
Epoch 129/300
5/5 [==============================] - 2s 312ms/step - loss: 0.0787 - val_loss: 0.0524
Epoch 130/300
5/5 [==============================] - 1s 303ms/step - loss: 0.0776 - val_loss: 0.0469
Epoch 131/300
5/5 [==============================] - 1s 298ms/step - loss: 0.0764 - val_loss: 0.0690
Epoch 132/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0803 - val_loss: 0.0484
Epoch 133/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0721 - val_loss: 0.0473
Epoch 134/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0710 - val_loss: 0.0463
Epoch 135/300
5/5 [==============================] - 2s 321ms/step - loss: 0.0712 - val_loss: 0.0478
Epoch 136/300
5/5 [==============================] - 2s 307ms/step - loss: 0.0692 - val_loss: 0.0471
Epoch 137/300
5/5 [==============================] - 2s 313ms/step - loss: 0.0686 - val_loss: 0.0467
Epoch 138/300
5/5 [==============================] - 2s 348ms/step - loss: 0.0673 - val_loss: 0.0466
Epoch 139/300
5/5 [==============================] - 2s 306ms/step - loss: 0.0666 - val_loss: 0.0543
Epoch 140/300
5/5 [==============================] - 1s 303ms/step - loss: 0.0699 - val_loss: 0.0525
Epoch 141/300
5/5 [==============================] - 1s 298ms/step - loss: 0.0726 - val_loss: 0.0582
Epoch 142/300
5/5 [==============================] - 1s 300ms/step - loss: 0.0678 - val_loss: 0.0479
Epoch 143/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0729 - val_loss: 0.0450
Epoch 144/300
5/5 [==============================] - 1s 297ms/step - loss: 0.0832 - val_loss: 0.0638
Epoch 145/300
5/5 [==============================] - 1s 305ms/step - loss: 0.0820 - val_loss: 0.0580
Epoch 146/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0739 - val_loss: 0.0507
Epoch 147/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0755 - val_loss: 0.0750
Epoch 148/300
5/5 [==============================] - 1s 305ms/step - loss: 0.0721 - val_loss: 0.0723
Epoch 149/300
5/5 [==============================] - 2s 314ms/step - loss: 0.0733 - val_loss: 0.0460
Epoch 150/300
5/5 [==============================] - 1s 306ms/step - loss: 0.0698 - val_loss: 0.0564
Epoch 151/300
5/5 [==============================] - 1s 300ms/step - loss: 0.0691 - val_loss: 0.0498
Epoch 152/300
5/5 [==============================] - 2s 302ms/step - loss: 0.0690 - val_loss: 0.0478
Epoch 153/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0694 - val_loss: 0.0676
Epoch 154/300
5/5 [==============================] - 2s 306ms/step - loss: 0.0742 - val_loss: 0.0572
Epoch 155/300
5/5 [==============================] - 2s 316ms/step - loss: 0.0718 - val_loss: 0.0546
Epoch 156/300
5/5 [==============================] - 1s 298ms/step - loss: 0.0691 - val_loss: 0.0451
Epoch 157/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0680 - val_loss: 0.0464
Epoch 158/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0643 - val_loss: 0.0569
Epoch 159/300
5/5 [==============================] - 1s 299ms/step - loss: 0.0648 - val_loss: 0.0653
Epoch 160/300
5/5 [==============================] - 2s 314ms/step - loss: 0.0623 - val_loss: 0.0569
Epoch 161/300
5/5 [==============================] - 1s 295ms/step - loss: 0.0643 - val_loss: 0.0437
Epoch 162/300
5/5 [==============================] - 1s 298ms/step - loss: 0.0633 - val_loss: 0.0481
Epoch 163/300
5/5 [==============================] - 1s 297ms/step - loss: 0.0625 - val_loss: 0.0711
Epoch 164/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0641 - val_loss: 0.0535
Epoch 165/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0651 - val_loss: 0.0503
Epoch 166/300
5/5 [==============================] - 2s 306ms/step - loss: 0.0621 - val_loss: 0.0599
Epoch 167/300
5/5 [==============================] - 2s 321ms/step - loss: 0.0571 - val_loss: 0.0633
Epoch 168/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0566 - val_loss: 0.0401
Epoch 169/300
5/5 [==============================] - 2s 335ms/step - loss: 0.0580 - val_loss: 0.0432
Epoch 170/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0584 - val_loss: 0.0521
Epoch 171/300
5/5 [==============================] - 2s 368ms/step - loss: 0.0575 - val_loss: 0.0683
Epoch 172/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0575 - val_loss: 0.0480
Epoch 173/300
5/5 [==============================] - 2s 307ms/step - loss: 0.0523 - val_loss: 0.0425
Epoch 174/300
5/5 [==============================] - 2s 352ms/step - loss: 0.0508 - val_loss: 0.0486
Epoch 175/300
5/5 [==============================] - 2s 338ms/step - loss: 0.0482 - val_loss: 0.0460
Epoch 176/300
5/5 [==============================] - 2s 407ms/step - loss: 0.0557 - val_loss: 0.0439
Epoch 177/300
5/5 [==============================] - 2s 410ms/step - loss: 0.0562 - val_loss: 0.0609
Epoch 178/300
5/5 [==============================] - 2s 339ms/step - loss: 0.0637 - val_loss: 0.0506
Epoch 179/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0565 - val_loss: 0.0511
Epoch 180/300
5/5 [==============================] - 1s 295ms/step - loss: 0.0520 - val_loss: 0.0511
Epoch 181/300
5/5 [==============================] - 1s 296ms/step - loss: 0.0464 - val_loss: 0.0490
Epoch 182/300
5/5 [==============================] - 2s 319ms/step - loss: 0.0462 - val_loss: 0.0885
Epoch 183/300
5/5 [==============================] - 1s 303ms/step - loss: 0.0455 - val_loss: 0.0619
Epoch 184/300
5/5 [==============================] - 2s 306ms/step - loss: 0.0424 - val_loss: 0.0441
Epoch 185/300
5/5 [==============================] - 1s 298ms/step - loss: 0.0431 - val_loss: 0.0395
Epoch 186/300
5/5 [==============================] - 2s 392ms/step - loss: 0.0418 - val_loss: 0.0444
Epoch 187/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0416 - val_loss: 0.0558
Epoch 188/300
5/5 [==============================] - 2s 309ms/step - loss: 0.0409 - val_loss: 0.0415
Epoch 189/300
5/5 [==============================] - 2s 315ms/step - loss: 0.0414 - val_loss: 0.0537
Epoch 190/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0443 - val_loss: 0.0578
Epoch 191/300
5/5 [==============================] - 2s 332ms/step - loss: 0.0413 - val_loss: 0.0520
Epoch 192/300
5/5 [==============================] - 2s 362ms/step - loss: 0.0400 - val_loss: 0.0456
Epoch 193/300
5/5 [==============================] - 2s 385ms/step - loss: 0.0459 - val_loss: 0.0440
Epoch 194/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0437 - val_loss: 0.0562
Epoch 195/300
5/5 [==============================] - 1s 304ms/step - loss: 0.0426 - val_loss: 0.0436
Epoch 196/300
5/5 [==============================] - 1s 296ms/step - loss: 0.0399 - val_loss: 0.0467
Epoch 197/300
5/5 [==============================] - 1s 296ms/step - loss: 0.0405 - val_loss: 0.0586
Epoch 198/300
5/5 [==============================] - 2s 377ms/step - loss: 0.0404 - val_loss: 0.0567
Epoch 199/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0375 - val_loss: 0.0559
Epoch 200/300
5/5 [==============================] - 2s 356ms/step - loss: 0.0341 - val_loss: 0.0390
Epoch 201/300
5/5 [==============================] - 2s 367ms/step - loss: 0.0333 - val_loss: 0.0463
Epoch 202/300
5/5 [==============================] - 2s 310ms/step - loss: 0.0368 - val_loss: 0.0382
Epoch 203/300
5/5 [==============================] - 2s 307ms/step - loss: 0.0358 - val_loss: 0.0519
Epoch 204/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0349 - val_loss: 0.0325
Epoch 205/300
5/5 [==============================] - 2s 319ms/step - loss: 0.0429 - val_loss: 0.0314
Epoch 206/300
5/5 [==============================] - 1s 302ms/step - loss: 0.0444 - val_loss: 0.1003
Epoch 207/300
5/5 [==============================] - 2s 324ms/step - loss: 0.0460 - val_loss: 0.0481
Epoch 208/300
5/5 [==============================] - 1s 301ms/step - loss: 0.0408 - val_loss: 0.0436
Epoch 209/300
5/5 [==============================] - 1s 300ms/step - loss: 0.0467 - val_loss: 0.0651
Epoch 210/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0423 - val_loss: 0.0350
Epoch 211/300
5/5 [==============================] - 2s 349ms/step - loss: 0.0429 - val_loss: 0.0402
Epoch 212/300
5/5 [==============================] - 2s 322ms/step - loss: 0.0373 - val_loss: 0.0430
Epoch 213/300
5/5 [==============================] - 2s 331ms/step - loss: 0.0404 - val_loss: 0.0449
Epoch 214/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0381 - val_loss: 0.0396
Epoch 215/300
5/5 [==============================] - 2s 308ms/step - loss: 0.0363 - val_loss: 0.0482
Epoch 216/300
5/5 [==============================] - 2s 320ms/step - loss: 0.0303 - val_loss: 0.0427
Epoch 217/300
5/5 [==============================] - 2s 350ms/step - loss: 0.0325 - val_loss: 0.0431
Epoch 218/300
5/5 [==============================] - 2s 313ms/step - loss: 0.0305 - val_loss: 0.0357
Epoch 219/300
5/5 [==============================] - 2s 383ms/step - loss: 0.0329 - val_loss: 0.0364
Epoch 220/300
5/5 [==============================] - 2s 320ms/step - loss: 0.0327 - val_loss: 0.0395
Epoch 221/300
5/5 [==============================] - 2s 302ms/step - loss: 0.0272 - val_loss: 0.0433
Epoch 222/300
5/5 [==============================] - 2s 372ms/step - loss: 0.0313 - val_loss: 0.0433
Epoch 223/300
5/5 [==============================] - 2s 324ms/step - loss: 0.0298 - val_loss: 0.0334
Epoch 224/300
5/5 [==============================] - 2s 374ms/step - loss: 0.0301 - val_loss: 0.0540
Epoch 225/300
5/5 [==============================] - 2s 393ms/step - loss: 0.0500 - val_loss: 0.0547
Epoch 226/300
5/5 [==============================] - 2s 418ms/step - loss: 0.0471 - val_loss: 0.0436
Epoch 227/300
5/5 [==============================] - 2s 361ms/step - loss: 0.0480 - val_loss: 0.0606
Epoch 228/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0506 - val_loss: 0.0418
Epoch 229/300
5/5 [==============================] - 2s 386ms/step - loss: 0.0423 - val_loss: 0.0470
Epoch 230/300
5/5 [==============================] - 2s 402ms/step - loss: 0.0393 - val_loss: 0.0414
Epoch 231/300
5/5 [==============================] - 2s 448ms/step - loss: 0.0383 - val_loss: 0.0343
Epoch 232/300
5/5 [==============================] - 2s 424ms/step - loss: 0.0378 - val_loss: 0.0385
Epoch 233/300
5/5 [==============================] - 2s 437ms/step - loss: 0.0386 - val_loss: 0.0345
Epoch 234/300
5/5 [==============================] - 2s 471ms/step - loss: 0.0368 - val_loss: 0.0596
Epoch 235/300
5/5 [==============================] - 2s 456ms/step - loss: 0.0365 - val_loss: 0.0487
Epoch 236/300
5/5 [==============================] - 2s 409ms/step - loss: 0.0392 - val_loss: 0.0328
Epoch 237/300
5/5 [==============================] - 2s 370ms/step - loss: 0.0354 - val_loss: 0.0508
Epoch 238/300
5/5 [==============================] - 2s 415ms/step - loss: 0.0365 - val_loss: 0.0420
Epoch 239/300
5/5 [==============================] - 2s 391ms/step - loss: 0.0417 - val_loss: 0.0347
Epoch 240/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0390 - val_loss: 0.0402
Epoch 241/300
5/5 [==============================] - 2s 335ms/step - loss: 0.0333 - val_loss: 0.0401
Epoch 242/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0333 - val_loss: 0.0497
Epoch 243/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0309 - val_loss: 0.0602
Epoch 244/300
5/5 [==============================] - 2s 394ms/step - loss: 0.0300 - val_loss: 0.0353
Epoch 245/300
5/5 [==============================] - 2s 388ms/step - loss: 0.0280 - val_loss: 0.0314
Epoch 246/300
5/5 [==============================] - 2s 389ms/step - loss: 0.0273 - val_loss: 0.0362
Epoch 247/300
5/5 [==============================] - 2s 398ms/step - loss: 0.0290 - val_loss: 0.0412
Epoch 248/300
5/5 [==============================] - 2s 372ms/step - loss: 0.0282 - val_loss: 0.0349
Epoch 249/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0293 - val_loss: 0.0290
Epoch 250/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0246 - val_loss: 0.0326
Epoch 251/300
5/5 [==============================] - 2s 353ms/step - loss: 0.0240 - val_loss: 0.0434
Epoch 252/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0241 - val_loss: 0.0291
Epoch 253/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0248 - val_loss: 0.0499
Epoch 254/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0250 - val_loss: 0.0325
Epoch 255/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0245 - val_loss: 0.0305
Epoch 256/300
5/5 [==============================] - 2s 376ms/step - loss: 0.0256 - val_loss: 0.0312
Epoch 257/300
5/5 [==============================] - 2s 347ms/step - loss: 0.0306 - val_loss: 0.0430
Epoch 258/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0299 - val_loss: 0.0417
Epoch 259/300
5/5 [==============================] - 2s 403ms/step - loss: 0.0280 - val_loss: 0.0361
Epoch 260/300
5/5 [==============================] - 2s 355ms/step - loss: 0.0315 - val_loss: 0.0446
Epoch 261/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0297 - val_loss: 0.0315
Epoch 262/300
5/5 [==============================] - 2s 459ms/step - loss: 0.0274 - val_loss: 0.0386
Epoch 263/300
5/5 [==============================] - 2s 413ms/step - loss: 0.0248 - val_loss: 0.0351
Epoch 264/300
5/5 [==============================] - 2s 431ms/step - loss: 0.0254 - val_loss: 0.0398
Epoch 265/300
5/5 [==============================] - 2s 451ms/step - loss: 0.0239 - val_loss: 0.0368
Epoch 266/300
5/5 [==============================] - 2s 414ms/step - loss: 0.0241 - val_loss: 0.0313
Epoch 267/300
5/5 [==============================] - 2s 444ms/step - loss: 0.0230 - val_loss: 0.0280
Epoch 268/300
5/5 [==============================] - 2s 465ms/step - loss: 0.0241 - val_loss: 0.0295
Epoch 269/300
5/5 [==============================] - 2s 426ms/step - loss: 0.0249 - val_loss: 0.0350
Epoch 270/300
5/5 [==============================] - 2s 434ms/step - loss: 0.0260 - val_loss: 0.0422
Epoch 271/300
5/5 [==============================] - 2s 425ms/step - loss: 0.0247 - val_loss: 0.0324
Epoch 272/300
5/5 [==============================] - 2s 455ms/step - loss: 0.0240 - val_loss: 0.0350
Epoch 273/300
5/5 [==============================] - 2s 452ms/step - loss: 0.0221 - val_loss: 0.0475
Epoch 274/300
5/5 [==============================] - 2s 454ms/step - loss: 0.0210 - val_loss: 0.0292
Epoch 275/300
5/5 [==============================] - 2s 441ms/step - loss: 0.0259 - val_loss: 0.0326
Epoch 276/300
5/5 [==============================] - 2s 444ms/step - loss: 0.0223 - val_loss: 0.0286
Epoch 277/300
5/5 [==============================] - 2s 394ms/step - loss: 0.0218 - val_loss: 0.0317
Epoch 278/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0226 - val_loss: 0.0368
Epoch 279/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0229 - val_loss: 0.0268
Epoch 280/300
5/5 [==============================] - 2s 346ms/step - loss: 0.0231 - val_loss: 0.0368
Epoch 281/300
5/5 [==============================] - 2s 340ms/step - loss: 0.0245 - val_loss: 0.0307
Epoch 282/300
5/5 [==============================] - 2s 359ms/step - loss: 0.0257 - val_loss: 0.0297
Epoch 283/300
5/5 [==============================] - 2s 343ms/step - loss: 0.0282 - val_loss: 0.0345
Epoch 284/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0263 - val_loss: 0.0375
Epoch 285/300
5/5 [==============================] - 2s 341ms/step - loss: 0.0259 - val_loss: 0.0283
Epoch 286/300
5/5 [==============================] - 2s 363ms/step - loss: 0.0244 - val_loss: 0.0375
Epoch 287/300
5/5 [==============================] - 2s 365ms/step - loss: 0.0217 - val_loss: 0.0302
Epoch 288/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0196 - val_loss: 0.0303
Epoch 289/300
5/5 [==============================] - 2s 406ms/step - loss: 0.0219 - val_loss: 0.0367
Epoch 290/300
5/5 [==============================] - 2s 382ms/step - loss: 0.0267 - val_loss: 0.0308
Epoch 291/300
5/5 [==============================] - 2s 373ms/step - loss: 0.0261 - val_loss: 0.0334
Epoch 292/300
5/5 [==============================] - 2s 383ms/step - loss: 0.0312 - val_loss: 0.0319
Epoch 293/300
5/5 [==============================] - 2s 379ms/step - loss: 0.0295 - val_loss: 0.0366
Epoch 294/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0331 - val_loss: 0.0342
Epoch 295/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0312 - val_loss: 0.0432
Epoch 296/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0297 - val_loss: 0.0449
Epoch 297/300
5/5 [==============================] - 2s 342ms/step - loss: 0.0289 - val_loss: 0.0356
Epoch 298/300
5/5 [==============================] - 2s 345ms/step - loss: 0.0254 - val_loss: 0.0326
Epoch 299/300
5/5 [==============================] - 2s 351ms/step - loss: 0.0228 - val_loss: 0.0327
Epoch 300/300
5/5 [==============================] - 2s 336ms/step - loss: 0.0192 - val_loss: 0.0332
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_28_1.png" src="../../_images/Forecaster_examples_LSTM_28_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_28_2.png" src="../../_images/Forecaster_examples_LSTM_28_2.png" />
</div>
</div>
</section>
</section>
<section id="MLR-Modeling">
<h2>MLR Modeling<a class="headerlink" href="#MLR-Modeling" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">set_estimator</span><span class="p">(</span><span class="s1">&#39;mlr&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">add_ar_terms</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">add_seasonal_regressors</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;quarter&#39;</span><span class="p">,</span><span class="n">dummy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">add_seasonal_regressors</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">add_time_trend</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">manual_forecast</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">,</span><span class="n">models</span><span class="o">=</span><span class="s1">&#39;top_3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_31_0.png" src="../../_images/Forecaster_examples_LSTM_31_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">plot_test_set</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="s1">&#39;mlr&#39;</span><span class="p">,</span><span class="n">ci</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_32_0.png" src="../../_images/Forecaster_examples_LSTM_32_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">,</span><span class="n">models</span><span class="o">=</span><span class="s1">&#39;top_3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Forecaster_examples_LSTM_33_0.png" src="../../_images/Forecaster_examples_LSTM_33_0.png" />
</div>
</div>
</section>
<section id="Benchmarking">
<h2>Benchmarking<a class="headerlink" href="#Benchmarking" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;model_summaries&#39;</span><span class="p">,</span><span class="n">determine_best_by</span><span class="o">=</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s1">&#39;ModelNickname&#39;</span><span class="p">,</span><span class="s1">&#39;LevelTestSetMAPE&#39;</span><span class="p">,</span><span class="s1">&#39;LevelTestSetRMSE&#39;</span><span class="p">,</span><span class="s1">&#39;LevelTestSetR2&#39;</span><span class="p">,</span><span class="s1">&#39;best_model&#39;</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ModelNickname</th>
      <th>LevelTestSetMAPE</th>
      <th>LevelTestSetRMSE</th>
      <th>LevelTestSetR2</th>
      <th>best_model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mlr</td>
      <td>0.023420</td>
      <td>13.932124</td>
      <td>0.964960</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>lstm_24lags_4layers_15epochs</td>
      <td>0.114650</td>
      <td>81.210940</td>
      <td>-0.190586</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lstm_best</td>
      <td>0.154356</td>
      <td>93.090478</td>
      <td>-0.564380</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lstm_24lags_earlystop_3layers</td>
      <td>0.375480</td>
      <td>198.842435</td>
      <td>-6.137560</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>lstm_24lags</td>
      <td>0.712334</td>
      <td>362.077454</td>
      <td>-22.666530</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>lstm_24lags_5epochs</td>
      <td>0.719090</td>
      <td>347.686110</td>
      <td>-20.822590</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>lstm_default</td>
      <td>0.779915</td>
      <td>379.298924</td>
      <td>-24.971368</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Export-Results">
<h2>Export Results<a class="headerlink" href="#Export-Results" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">export_forecasts_with_cis</span><span class="p">(</span><span class="s1">&#39;mlr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>UpperForecast</th>
      <th>Forecast</th>
      <th>LowerForecast</th>
      <th>ModelNickname</th>
      <th>CILevel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1961-01-01</td>
      <td>47.711290</td>
      <td>30.246319</td>
      <td>12.781347</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961-02-01</td>
      <td>-27.057760</td>
      <td>-44.522731</td>
      <td>-61.987702</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1961-03-01</td>
      <td>61.142910</td>
      <td>43.677939</td>
      <td>26.212968</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1961-04-01</td>
      <td>46.528396</td>
      <td>29.063425</td>
      <td>11.598454</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1961-05-01</td>
      <td>29.862361</td>
      <td>12.397390</td>
      <td>-5.067581</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1961-06-01</td>
      <td>90.724956</td>
      <td>73.259985</td>
      <td>55.795014</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1961-07-01</td>
      <td>123.005797</td>
      <td>105.540825</td>
      <td>88.075854</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1961-08-01</td>
      <td>-16.122173</td>
      <td>-33.587144</td>
      <td>-51.052115</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1961-09-01</td>
      <td>-73.067354</td>
      <td>-90.532325</td>
      <td>-107.997296</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1961-10-01</td>
      <td>-41.907826</td>
      <td>-59.372797</td>
      <td>-76.837768</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1961-11-01</td>
      <td>-54.975544</td>
      <td>-72.440515</td>
      <td>-89.905487</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1961-12-01</td>
      <td>66.035665</td>
      <td>48.570694</td>
      <td>31.105723</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">export_test_set_preds_with_cis</span><span class="p">(</span><span class="s1">&#39;mlr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>UpperPreds</th>
      <th>Preds</th>
      <th>Actuals</th>
      <th>LowerPreds</th>
      <th>ModelNickname</th>
      <th>CILevel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960-01-01</td>
      <td>28.066682</td>
      <td>10.601711</td>
      <td>12.0</td>
      <td>-6.863261</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1960-02-01</td>
      <td>0.741874</td>
      <td>-16.723097</td>
      <td>-26.0</td>
      <td>-34.188068</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1960-03-01</td>
      <td>65.886942</td>
      <td>48.421971</td>
      <td>28.0</td>
      <td>30.956999</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1960-04-01</td>
      <td>2.898761</td>
      <td>-14.566210</td>
      <td>42.0</td>
      <td>-32.031182</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1960-05-01</td>
      <td>50.348916</td>
      <td>32.883945</td>
      <td>11.0</td>
      <td>15.418974</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1960-06-01</td>
      <td>78.363001</td>
      <td>60.898029</td>
      <td>63.0</td>
      <td>43.433058</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1960-07-01</td>
      <td>103.669621</td>
      <td>86.204650</td>
      <td>87.0</td>
      <td>68.739679</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1960-08-01</td>
      <td>23.470167</td>
      <td>6.005196</td>
      <td>-16.0</td>
      <td>-11.459775</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1960-09-01</td>
      <td>-86.780501</td>
      <td>-104.245472</td>
      <td>-98.0</td>
      <td>-121.710443</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1960-10-01</td>
      <td>-51.156100</td>
      <td>-68.621071</td>
      <td>-47.0</td>
      <td>-86.086042</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1960-11-01</td>
      <td>-43.972634</td>
      <td>-61.437606</td>
      <td>-71.0</td>
      <td>-78.902577</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1960-12-01</td>
      <td>66.544516</td>
      <td>49.079545</td>
      <td>42.0</td>
      <td>31.614574</td>
      <td>mlr</td>
      <td>0.95</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="Export-Feature-Info">
<h3>Export Feature Info<a class="headerlink" href="#Export-Feature-Info" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">save_feature_importance</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">export_feature_importance</span><span class="p">(</span><span class="s1">&#39;mlr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weight</th>
      <th>std</th>
    </tr>
    <tr>
      <th>feature</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AR1</th>
      <td>0.360410</td>
      <td>0.057652</td>
    </tr>
    <tr>
      <th>AR12</th>
      <td>0.218659</td>
      <td>0.026116</td>
    </tr>
    <tr>
      <th>AR4</th>
      <td>0.214434</td>
      <td>0.031875</td>
    </tr>
    <tr>
      <th>AR10</th>
      <td>0.184816</td>
      <td>0.017657</td>
    </tr>
    <tr>
      <th>AR21</th>
      <td>0.131055</td>
      <td>0.009248</td>
    </tr>
    <tr>
      <th>AR13</th>
      <td>0.116967</td>
      <td>0.011384</td>
    </tr>
    <tr>
      <th>AR18</th>
      <td>0.111233</td>
      <td>0.012176</td>
    </tr>
    <tr>
      <th>AR2</th>
      <td>0.088423</td>
      <td>0.019647</td>
    </tr>
    <tr>
      <th>AR11</th>
      <td>0.085070</td>
      <td>0.011649</td>
    </tr>
    <tr>
      <th>AR20</th>
      <td>0.080938</td>
      <td>0.011092</td>
    </tr>
    <tr>
      <th>AR3</th>
      <td>0.071639</td>
      <td>0.014407</td>
    </tr>
    <tr>
      <th>AR22</th>
      <td>0.065199</td>
      <td>0.003837</td>
    </tr>
    <tr>
      <th>AR7</th>
      <td>0.063136</td>
      <td>0.003587</td>
    </tr>
    <tr>
      <th>AR8</th>
      <td>0.057833</td>
      <td>0.006383</td>
    </tr>
    <tr>
      <th>month_9</th>
      <td>0.044074</td>
      <td>0.003543</td>
    </tr>
    <tr>
      <th>AR9</th>
      <td>0.043885</td>
      <td>0.002790</td>
    </tr>
    <tr>
      <th>AR14</th>
      <td>0.034640</td>
      <td>0.007735</td>
    </tr>
    <tr>
      <th>AR17</th>
      <td>0.033160</td>
      <td>0.002823</td>
    </tr>
    <tr>
      <th>AR24</th>
      <td>0.031625</td>
      <td>0.003686</td>
    </tr>
    <tr>
      <th>AR23</th>
      <td>0.030453</td>
      <td>0.002730</td>
    </tr>
    <tr>
      <th>AR19</th>
      <td>0.020941</td>
      <td>0.001888</td>
    </tr>
    <tr>
      <th>month_7</th>
      <td>0.013514</td>
      <td>0.002930</td>
    </tr>
    <tr>
      <th>AR5</th>
      <td>0.008518</td>
      <td>0.000783</td>
    </tr>
    <tr>
      <th>month_8</th>
      <td>0.007976</td>
      <td>0.002222</td>
    </tr>
    <tr>
      <th>month_2</th>
      <td>0.007844</td>
      <td>0.002097</td>
    </tr>
    <tr>
      <th>AR16</th>
      <td>0.006507</td>
      <td>0.002998</td>
    </tr>
    <tr>
      <th>month_10</th>
      <td>0.006464</td>
      <td>0.001107</td>
    </tr>
    <tr>
      <th>month_11</th>
      <td>0.003286</td>
      <td>0.000805</td>
    </tr>
    <tr>
      <th>AR6</th>
      <td>0.003027</td>
      <td>0.000783</td>
    </tr>
    <tr>
      <th>month_3</th>
      <td>0.002440</td>
      <td>0.001107</td>
    </tr>
    <tr>
      <th>year</th>
      <td>0.002268</td>
      <td>0.000767</td>
    </tr>
    <tr>
      <th>month</th>
      <td>0.001389</td>
      <td>0.000671</td>
    </tr>
    <tr>
      <th>month_12</th>
      <td>0.001126</td>
      <td>0.000959</td>
    </tr>
    <tr>
      <th>quarter_2</th>
      <td>0.000940</td>
      <td>0.000174</td>
    </tr>
    <tr>
      <th>month_1</th>
      <td>0.000728</td>
      <td>0.001333</td>
    </tr>
    <tr>
      <th>AR15</th>
      <td>0.000653</td>
      <td>0.000701</td>
    </tr>
    <tr>
      <th>t</th>
      <td>0.000439</td>
      <td>0.000580</td>
    </tr>
    <tr>
      <th>month_6</th>
      <td>0.000257</td>
      <td>0.000201</td>
    </tr>
    <tr>
      <th>month_5</th>
      <td>0.000195</td>
      <td>0.000508</td>
    </tr>
    <tr>
      <th>month_4</th>
      <td>0.000147</td>
      <td>0.000201</td>
    </tr>
    <tr>
      <th>quarter_1</th>
      <td>0.000085</td>
      <td>0.000297</td>
    </tr>
    <tr>
      <th>quarter_4</th>
      <td>0.000043</td>
      <td>0.000198</td>
    </tr>
    <tr>
      <th>quarter</th>
      <td>0.000022</td>
      <td>0.000066</td>
    </tr>
    <tr>
      <th>quarter_3</th>
      <td>0.000012</td>
      <td>0.000040</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="eCommerce.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Forecaster.html" class="btn btn-neutral float-right" title="Forecaster Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Michael Keith.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>